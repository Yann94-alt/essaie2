<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Todo List</title>

<style>
body{
    font-family: Arial, sans-serif;
    background-color: #f2f2f2;
    padding: 20px;
}

button{
    padding: 6px 10px;
    margin: 2px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.add{ background: green; color: white; }
.red{ background: red; color: white; }
.re{ background: blue; color: white; }
.doneBtn{ background: orange; color: white; }

li{
    background: white;
    margin: 8px 0;
    padding: 10px;
    list-style: none;
    border-radius: 5px;
}

/* t√¢che termin√©e */
.done span{
    text-decoration: line-through;
    color: gray;
}
</style>
</head>

<body>

<h1>TODO LIST</h1>

<input type="text" id="text" placeholder="Entrer une t√¢che">
<button class="add" onclick="afficher()">Ajouter</button>

<p id="count">T√¢ches : 0</p>
<p id="empty">Aucune t√¢che</p>

<ul id="aff"></ul>

<script>

/* ============================= */
/*  CHARGER LES T√ÇCHES AU D√âPART */
/* ============================= */
window.onload = function(){
    loadTasks();
    updateCount();
    checkEmpty();
}

/* ============================= */
/*  AJOUTER UNE T√ÇCHE            */
/* ============================= */
function afficher(){
    const text = document.getElementById("text").value.trim();

    if(text === ""){
        alert("Veuillez entrer une t√¢che");
        return;
    }

    const li = document.createElement("li");

    li.innerHTML = `
        <span>${text}</span>
        <button class="doneBtn" onclick="finish(this)">Termin√©</button>
        <button class="re" onclick="edit(this)">Modifier</button>
        <button class="red" onclick="delet(this)">Supprimer</button>
    `;

    document.getElementById("aff").appendChild(li);
    document.getElementById("text").value = "";

    saveTasks();     // üî• sauvegarder
    updateCount();
    checkEmpty();
}

/* ============================= */
/*  TERMINER UNE T√ÇCHE           */
/* ============================= */
function finish(button){
    const li = button.parentElement;
    li.classList.toggle("done");

    saveTasks(); // üî• sauvegarder l'√©tat termin√©
}

/* ============================= */
/*  MODIFIER UNE T√ÇCHE           */
/* ============================= */
function edit(button){
    const li = button.parentElement;
    const span = li.querySelector("span");

    const newtext = prompt("Modifier la t√¢che", span.textContent);

    if(newtext !== null && newtext.trim() !== ""){
        span.textContent = newtext;
        saveTasks(); // üî• sauvegarder le nouveau texte
    }
}

/* ============================= */
/*  SUPPRIMER UNE T√ÇCHE          */
/* ============================= */
function delet(button){
    if(confirm("Supprimer cette t√¢che ?")){
        button.parentElement.remove();

        saveTasks(); // üî• sauvegarder
        updateCount();
        checkEmpty();
    }
}

/* ============================= */
/*  COMPTEUR DE T√ÇCHES           */
/* ============================= */
function updateCount(){
    const tasks = document.querySelectorAll("li");
    document.getElementById("count").textContent =
        "T√¢ches : " + tasks.length;
}

/* ============================= */
/*  MESSAGE LISTE VIDE           */
/* ============================= */
function checkEmpty(){
    const tasks = document.querySelectorAll("li");
    document.getElementById("empty").style.display =
        tasks.length === 0 ? "block" : "none";
}

/* ============================= */
/*  SAUVEGARDER LES T√ÇCHES üíæ    */
/* ============================= */
function saveTasks(){
    const tasks = [];
    document.querySelectorAll("li").forEach(li => {
        tasks.push({
            text: li.querySelector("span").textContent,
            done: li.classList.contains("done")
        });
    });

    localStorage.setItem("tasks", JSON.stringify(tasks));
}

// laisser le sauvegarde
function loadTasks(){
    const saved = JSON.parse(localStorage.getItem("tasks")) || [];

    saved.forEach(task => {
        const li = document.createElement("li");

        if(task.done){
            li.classList.add("done");
        }

        li.innerHTML = `
            <span>${task.text}</span>
            <button class="doneBtn" onclick="finish(this)">Termin√©</button>
            <button class="re" onclick="edit(this)">Modifier</button>
            <button class="red" onclick="delet(this)">Supprimer</button>
        `;

        document.getElementById("aff").appendChild(li);
    });
}

</script>

</body>
</html>
